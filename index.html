<!DOCTYPE html>
<html>
<head>
<title>Transaction Entry</title>
<style>
  body { font-family: Arial; max-width: 500px; margin: auto; }
  input, select, button { width: 100%; padding: 8px; margin: 5px 0; }
</style>
</head>
<body>
<h2>Enter Transaction</h2>
<form id="transactionForm">
  <label>Account</label>
  <select name="sheetName" required>
    <option value="">-- Select Account --</option>
    <option value="Kotak SRG">Kotak SRG</option>
    <option value="UBI SRG">UBI SRG</option>
  </select>

  <label>Date</label>
  <input type="date" name="date" required>

  <label>Particulars</label>
  <input type="text" name="particulars" required>

  <label>Type</label>
  <select name="type" required>
    <option value="">-- Select Type --</option>
    <option value="Debit">Debit</option>
    <option value="Credit">Credit</option>
  </select>

  <label>Amount</label>
  <input type="number" step="0.01" name="amount" required>

  <label>Remarks</label>
  <input type="text" name="remarks">

  <button type="submit">Submit</button>
</form>
<p id="status"></p>

<script>
document.getElementById("transactionForm").addEventListener("submit", function(e) {
  e.preventDefault();

  const form = this;
  const type = form.type.value;
  let debitValue = "";
  let creditValue = "";

  if (type === "Debit") {
    debitValue = form.amount.value;
  } else if (type === "Credit") {
    creditValue = form.amount.value;
  }

  fetch("https://script.google.com/macros/s/AKfycbyADfOVtFrYyaRPZelhL_BA9sH6OfvHLm_lbvZUUnZkjGxpwl9mAvKuj7d-AHsMNPJD-A/exec", {
    method: "POST",
    mode: "cors", // explicitly request CORS
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      sheetName: form.sheetName.value,
      date: form.date.value,
      particulars: form.particulars.value,
      debit: debitValue,
      credit: creditValue,
      amount: form.amount.value,
      remarks: form.remarks.value || ""
    })
  })
  .then(res => {
    if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
    return res.json();
  })
  .then(data => {
    if (data.status === "success") {
      document.getElementById("status").innerText = "✅ Transaction Saved!";
      form.reset();
    } else {
      document.getElementById("status").innerText = "❌ Error: " + (data.message || "Unknown error");
    }
  })
  .catch(err => {
    document.getElementById("status").innerText = "❌ Error saving transaction: " + err;
  });
});
</script>
</body>
</html>
