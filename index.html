<!DOCTYPE html>
<html>
<head>
<title>Transaction Entry</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 500px; margin: auto; background: #f7f7f7; padding: 20px; }
  h2 { text-align: center; }
  form { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
  label { font-weight: bold; display: block; margin-top: 10px; }
  input, select, button {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
  }
  button {
    background: #28a745;
    color: white;
    font-size: 16px;
    margin-top: 15px;
    cursor: pointer;
    border: none;
  }
  button:hover {
    background: #218838;
  }
  #status {
    margin-top: 15px;
    text-align: center;
    font-weight: bold;
  }
</style>
</head>
<body>
<h2>Enter Transaction</h2>
<form id="transactionForm">
  <label>Account</label>
  <select name="sheetName" required>
    <option value="">-- Select Account --</option>
    <option value="Kotak SRG">Kotak SRG</option>
    <option value="UBI SRG">UBI SRG</option>
  </select>

  <label>Date</label>
  <input type="date" name="date" required>

  <label>Particulars</label>
  <input type="text" name="particulars" required>

  <label>Type</label>
  <select name="type" required>
    <option value="">-- Select Type --</option>
    <option value="Debit">Debit</option>
    <option value="Credit">Credit</option>
  </select>

  <label>Amount</label>
  <input type="number" step="0.01" name="amount" required>

  <label>Remarks</label>
  <input type="text" name="remarks">

  <button type="submit">Submit</button>
</form>
<p id="status"></p>

<script>
document.getElementById("transactionForm").addEventListener("submit", function(e) {
  e.preventDefault();
  
  const form = this;
  const type = form.type.value;
  let debitValue = "";
  let creditValue = "";
  
  if (type === "Debit") {
    debitValue = form.amount.value;
  } else if (type === "Credit") {
    creditValue = form.amount.value;
  }

  document.getElementById("status").innerText = "Saving transaction...";

  fetch("https://script.google.com/macros/s/AKfycbzIJFpP-bIgaZ4h2BfumOIQul758czEQL_91DowkQic3wQx7MzwtDQ6W0B-bPkVUa1YNA/exec", {
    method: "POST",
    body: JSON.stringify({
      sheetName: form.sheetName.value,
      date: form.date.value,
      particulars: form.particulars.value,
      debit: debitValue,
      credit: creditValue,
      amount: form.amount.value,
      remarks: form.remarks.value || ""
    }),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === "success") {
      document.getElementById("status").style.color = "green";
      document.getElementById("status").innerText = "✅ Transaction Saved!";
      form.reset();
    } else {
      throw new Error("Save failed");
    }
  })
  .catch(err => {
    document.getElementById("status").style.color = "red";
    document.getElementById("status").innerText = "❌ Error saving transaction.";
  });
});
</script>
</body>
</html>
