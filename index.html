<!DOCTYPE html>
<html>
<head>
<title>Transaction Entry</title>
<style>
  body { font-family: Arial; max-width: 500px; margin: auto; }
  input, select, button { width: 100%; padding: 8px; margin: 5px 0; }
</style>
</head>
<body>
<h2>Enter Transaction</h2>
<form id="transactionForm">
  <label>Account</label>
  <select name="sheetName" required>
    <option value="">-- Select Account --</option>
    <option value="Kotak SRG">Kotak SRG</option>
    <option value="UBI SRG">UBI SRG</option>
  </select>

  <label>Date</label>
  <input type="date" name="date" required>

  <label>Particulars</label>
  <input type="text" name="particulars" required>

  <label>Type</label>
  <select name="type" required>
    <option value="">-- Select Type --</option>
    <option value="Debit">Debit</option>
    <option value="Credit">Credit</option>
  </select>

  <label>Amount</label>
  <input type="number" step="0.01" name="amount" required>

  <label>Remarks</label>
  <input type="text" name="remarks">

  <button type="submit">Submit</button>
</form>
<p id="status"></p>

<script>
document.getElementById("transactionForm").addEventListener("submit", function(e) {
  e.preventDefault();
  
  const type = this.type.value;
  let debitValue = "";
  let creditValue = "";
  
  if (type === "Debit") {
    debitValue = this.amount.value;
  } else if (type === "Credit") {
    creditValue = this.amount.value;
  }

  fetch("https://script.google.com/macros/s/AKfycbzgIye3hWs6TS6jEOM9s20aEk6ChAdjsxBeZFmhkH8dweu2sLLPTQvMYC5stfABzCkzWQ/exec", {
    method: "POST",
    body: JSON.stringify({
      sheetName: this.sheetName.value,
      date: this.date.value,
      particulars: this.particulars.value,
      debit: debitValue,
      credit: creditValue,
      amount: this.amount.value,
      remarks: this.remarks.value || ""
    }),
    headers: { "Content-Type": "application/json" }
  }).then(res => res.json())
  .then(data => {
    if (data.status === "success") {
      document.getElementById("status").innerText = "Transaction Saved!";
      this.reset();
    } else {
      document.getElementById("status").innerText = "Error: " + JSON.stringify(data);
    }
  }).catch(err => {
    document.getElementById("status").innerText = "Error: " + err;
  });
});
</script>
</body>
</html>
